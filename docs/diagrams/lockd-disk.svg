<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="3552px" preserveAspectRatio="none" style="width:1609px;height:3552px;background:#FFFFFF;" version="1.1" viewBox="0 0 1609 3552" width="1609px" zoomAndPan="magnify">
  <rect width="100%" height="100%" fill="#ffffff"/><defs><filter height="300%" id="fzy2av3yoq3n2" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4" dy="4" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="none" filter="url(#fzy2av3yoq3n2)" height="143.0818" style="stroke:#000000;stroke-width:2;" width="512.4422" x="271.4464" y="1167.3665"/><g><title>Client</title><rect fill="#000000" fill-opacity="0.00000" height="1176.3985" width="8" x="22.8369" y="91.0679"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:5,5;" x1="26" x2="26" y1="91.0679" y2="1267.4664"/></g><line style="stroke:#A80036;stroke-width:1;" x1="26" x2="26" y1="1267.4664" y2="1310.4483"/><g><title>Client</title><rect fill="#000000" fill-opacity="0.00000" height="2155.3031" width="8" x="22.8369" y="1310.4483"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:5,5;" x1="26" x2="26" y1="1310.4483" y2="3465.7514"/></g><g><title>HTTP Handler</title><rect fill="#000000" fill-opacity="0.00000" height="1176.3985" width="8" x="331.8623" y="91.0679"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:5,5;" x1="335.4464" x2="335.4464" y1="91.0679" y2="1267.4664"/></g><line style="stroke:#A80036;stroke-width:1;" x1="335.4464" x2="335.4464" y1="1267.4664" y2="1310.4483"/><g><title>HTTP Handler</title><rect fill="#000000" fill-opacity="0.00000" height="2155.3031" width="8" x="331.8623" y="1310.4483"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:5,5;" x1="335.4464" x2="335.4464" y1="1310.4483" y2="3465.7514"/></g><g><title>Lease Cache</title><rect fill="#000000" fill-opacity="0.00000" height="1176.3985" width="8" x="506.6984" y="91.0679"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:5,5;" x1="510.0496" x2="510.0496" y1="91.0679" y2="1267.4664"/></g><line style="stroke:#A80036;stroke-width:1;" x1="510.0496" x2="510.0496" y1="1267.4664" y2="1310.4483"/><g><title>Lease Cache</title><rect fill="#000000" fill-opacity="0.00000" height="2155.3031" width="8" x="506.6984" y="1310.4483"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:5,5;" x1="510.0496" x2="510.0496" y1="1310.4483" y2="3465.7514"/></g><g><title>Payload Spool</title><rect fill="#000000" fill-opacity="0.00000" height="1176.3985" width="8" x="621.5961" y="91.0679"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:5,5;" x1="625.3472" x2="625.3472" y1="91.0679" y2="1267.4664"/></g><line style="stroke:#A80036;stroke-width:1;" x1="625.3472" x2="625.3472" y1="1267.4664" y2="1310.4483"/><g><title>Payload Spool</title><rect fill="#000000" fill-opacity="0.00000" height="2155.3031" width="8" x="621.5961" y="1310.4483"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:5,5;" x1="625.3472" x2="625.3472" y1="1310.4483" y2="3465.7514"/></g><g><title>disk.Store</title><rect fill="#000000" fill-opacity="0.00000" height="1176.3985" width="8" x="728.3668" y="91.0679"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:5,5;" x1="731.8449" x2="731.8449" y1="91.0679" y2="1267.4664"/></g><line style="stroke:#A80036;stroke-width:1;" x1="731.8449" x2="731.8449" y1="1267.4664" y2="1310.4483"/><g><title>disk.Store</title><rect fill="#000000" fill-opacity="0.00000" height="2155.3031" width="8" x="728.3668" y="1310.4483"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:5,5;" x1="731.8449" x2="731.8449" y1="1310.4483" y2="3465.7514"/></g><g><title>Global Mutex</title><rect fill="#000000" fill-opacity="0.00000" height="1176.3985" width="8" x="861.6449" y="91.0679"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:5,5;" x1="864.797" x2="864.797" y1="91.0679" y2="1267.4664"/></g><line style="stroke:#A80036;stroke-width:1;" x1="864.797" x2="864.797" y1="1267.4664" y2="1310.4483"/><g><title>Global Mutex</title><rect fill="#000000" fill-opacity="0.00000" height="2155.3031" width="8" x="861.6449" y="1310.4483"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:5,5;" x1="864.797" x2="864.797" y1="1310.4483" y2="3465.7514"/></g><g><title>Per-key Mutex</title><rect fill="#000000" fill-opacity="0.00000" height="1176.3985" width="8" x="980.7495" y="91.0679"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:5,5;" x1="984.4927" x2="984.4927" y1="91.0679" y2="1267.4664"/></g><line style="stroke:#A80036;stroke-width:1;" x1="984.4927" x2="984.4927" y1="1267.4664" y2="1310.4483"/><g><title>Per-key Mutex</title><rect fill="#000000" fill-opacity="0.00000" height="2155.3031" width="8" x="980.7495" y="1310.4483"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:5,5;" x1="984.4927" x2="984.4927" y1="1310.4483" y2="3465.7514"/></g><g><title>File Lock</title><rect fill="#000000" fill-opacity="0.00000" height="1176.3985" width="8" x="1084.0202" y="91.0679"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:5,5;" x1="1088.0063" x2="1088.0063" y1="91.0679" y2="1267.4664"/></g><line style="stroke:#A80036;stroke-width:1;" x1="1088.0063" x2="1088.0063" y1="1267.4664" y2="1310.4483"/><g><title>File Lock</title><rect fill="#000000" fill-opacity="0.00000" height="2155.3031" width="8" x="1084.0202" y="1310.4483"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:5,5;" x1="1088.0063" x2="1088.0063" y1="1310.4483" y2="3465.7514"/></g><g><title>meta..key..json</title><rect fill="#000000" fill-opacity="0.00000" height="1176.3985" width="8" x="1188.4449" y="91.0679"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:5,5;" x1="1192.0341" x2="1192.0341" y1="91.0679" y2="1267.4664"/></g><line style="stroke:#A80036;stroke-width:1;" x1="1192.0341" x2="1192.0341" y1="1267.4664" y2="1310.4483"/><g><title>meta..key..json</title><rect fill="#000000" fill-opacity="0.00000" height="2155.3031" width="8" x="1188.4449" y="1310.4483"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:5,5;" x1="1192.0341" x2="1192.0341" y1="1310.4483" y2="3465.7514"/></g><g><title>state..key..data</title><rect fill="#000000" fill-opacity="0.00000" height="1176.3985" width="8" x="1314.2954" y="91.0679"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:5,5;" x1="1317.8557" x2="1317.8557" y1="91.0679" y2="1267.4664"/></g><line style="stroke:#A80036;stroke-width:1;" x1="1317.8557" x2="1317.8557" y1="1267.4664" y2="1310.4483"/><g><title>state..key..data</title><rect fill="#000000" fill-opacity="0.00000" height="2155.3031" width="8" x="1314.2954" y="1310.4483"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:5,5;" x1="1317.8557" x2="1317.8557" y1="1310.4483" y2="3465.7514"/></g><g><title>state..key..info.json</title><rect fill="#000000" fill-opacity="0.00000" height="1176.3985" width="8" x="1454.86" y="91.0679"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:5,5;" x1="1458.7352" x2="1458.7352" y1="91.0679" y2="1267.4664"/></g><line style="stroke:#A80036;stroke-width:1;" x1="1458.7352" x2="1458.7352" y1="1267.4664" y2="1310.4483"/><g><title>state..key..info.json</title><rect fill="#000000" fill-opacity="0.00000" height="2155.3031" width="8" x="1454.86" y="1310.4483"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:5,5;" x1="1458.7352" x2="1458.7352" y1="1310.4483" y2="3465.7514"/></g><g><title>tmp dir</title><rect fill="#000000" fill-opacity="0.00000" height="1176.3985" width="8" x="1564.1836" y="91.0679"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:5,5;" x1="1567.9847" x2="1567.9847" y1="91.0679" y2="1267.4664"/></g><line style="stroke:#A80036;stroke-width:1;" x1="1567.9847" x2="1567.9847" y1="1267.4664" y2="1310.4483"/><g><title>tmp dir</title><rect fill="#000000" fill-opacity="0.00000" height="2155.3031" width="8" x="1564.1836" y="1310.4483"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:5,5;" x1="1567.9847" x2="1567.9847" y1="1310.4483" y2="3465.7514"/></g><g class="participant participant-head" data-participant="Client"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37.6738" x="5" y="86.9659">Client</text><ellipse cx="26.8369" cy="15" fill="#FEFECE" filter="url(#fzy2av3yoq3n2)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2;"/><path d="M26.8369,23 L26.8369,50 M13.8369,31 L39.8369,31 M26.8369,50 L13.8369,65 M26.8369,50 L39.8369,65" fill="none" filter="url(#fzy2av3yoq3n2)" style="stroke:#A80036;stroke-width:2;"/></g><g class="participant participant-tail" data-participant="Client"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37.6738" x="5" y="3479.7173">Client</text><ellipse cx="26.8369" cy="3493.8193" fill="#FEFECE" filter="url(#fzy2av3yoq3n2)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2;"/><path d="M26.8369,3501.8193 L26.8369,3528.8193 M13.8369,3509.8193 L39.8369,3509.8193 M26.8369,3528.8193 L13.8369,3543.8193 M26.8369,3528.8193 L39.8369,3543.8193" fill="none" filter="url(#fzy2av3yoq3n2)" style="stroke:#A80036;stroke-width:2;"/></g><g class="participant participant-head" data-participant="Handler"><rect fill="#FEFECE" filter="url(#fzy2av3yoq3n2)" height="33.0679" style="stroke:#A80036;stroke-width:1.5;" width="104.8316" x="281.4464" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="90.8316" x="288.4464" y="74.9659">HTTP Handler</text></g><g class="participant participant-tail" data-participant="Handler"><rect fill="#FEFECE" filter="url(#fzy2av3yoq3n2)" height="33.0679" style="stroke:#A80036;stroke-width:1.5;" width="104.8316" x="281.4464" y="3464.7514"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="90.8316" x="288.4464" y="3486.7173">HTTP Handler</text></g><g class="participant participant-head" data-participant="Cache"><rect fill="#FEFECE" filter="url(#fzy2av3yoq3n2)" height="33.0679" style="stroke:#A80036;stroke-width:1.5;" width="95.2977" x="461.0496" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81.2977" x="468.0496" y="74.9659">Lease Cache</text></g><g class="participant participant-tail" data-participant="Cache"><rect fill="#FEFECE" filter="url(#fzy2av3yoq3n2)" height="33.0679" style="stroke:#A80036;stroke-width:1.5;" width="95.2977" x="461.0496" y="3464.7514"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81.2977" x="468.0496" y="3486.7173">Lease Cache</text></g><g class="participant participant-head" data-participant="Spool"><rect fill="#FEFECE" filter="url(#fzy2av3yoq3n2)" height="33.0679" style="stroke:#A80036;stroke-width:1.5;" width="106.4977" x="570.3472" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.4977" x="577.3472" y="74.9659">Payload Spool</text></g><g class="participant participant-tail" data-participant="Spool"><rect fill="#FEFECE" filter="url(#fzy2av3yoq3n2)" height="33.0679" style="stroke:#A80036;stroke-width:1.5;" width="106.4977" x="570.3472" y="3464.7514"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.4977" x="577.3472" y="3486.7173">Payload Spool</text></g><g class="participant participant-head" data-participant="Disk"><rect fill="#FEFECE" filter="url(#fzy2av3yoq3n2)" height="33.0679" style="stroke:#A80036;stroke-width:1.5;" width="79.0438" x="690.8449" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="65.0438" x="697.8449" y="74.9659">disk.Store</text></g><g class="participant participant-tail" data-participant="Disk"><rect fill="#FEFECE" filter="url(#fzy2av3yoq3n2)" height="33.0679" style="stroke:#A80036;stroke-width:1.5;" width="79.0438" x="690.8449" y="3464.7514"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="65.0438" x="697.8449" y="3486.7173">disk.Store</text></g><g class="participant participant-head" data-participant="Global"><rect fill="#FEFECE" filter="url(#fzy2av3yoq3n2)" height="33.0679" style="stroke:#A80036;stroke-width:1.5;" width="101.6957" x="812.797" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.6957" x="819.797" y="74.9659">Global Mutex</text></g><g class="participant participant-tail" data-participant="Global"><rect fill="#FEFECE" filter="url(#fzy2av3yoq3n2)" height="33.0679" style="stroke:#A80036;stroke-width:1.5;" width="101.6957" x="812.797" y="3464.7514"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.6957" x="819.797" y="3486.7173">Global Mutex</text></g><g class="participant participant-head" data-participant="KeyMutex"><rect fill="#FEFECE" filter="url(#fzy2av3yoq3n2)" height="33.0679" style="stroke:#A80036;stroke-width:1.5;" width="108.5136" x="928.4927" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94.5136" x="935.4927" y="74.9659">Per-key Mutex</text></g><g class="participant participant-tail" data-participant="KeyMutex"><rect fill="#FEFECE" filter="url(#fzy2av3yoq3n2)" height="33.0679" style="stroke:#A80036;stroke-width:1.5;" width="108.5136" x="928.4927" y="3464.7514"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94.5136" x="935.4927" y="3486.7173">Per-key Mutex</text></g><g class="participant participant-head" data-participant="FileLock"><rect fill="#FEFECE" filter="url(#fzy2av3yoq3n2)" height="33.0679" style="stroke:#A80036;stroke-width:1.5;" width="70.0278" x="1051.0063" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56.0278" x="1058.0063" y="74.9659">File Lock</text></g><g class="participant participant-tail" data-participant="FileLock"><rect fill="#FEFECE" filter="url(#fzy2av3yoq3n2)" height="33.0679" style="stroke:#A80036;stroke-width:1.5;" width="70.0278" x="1051.0063" y="3464.7514"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56.0278" x="1058.0063" y="3486.7173">File Lock</text></g><g class="participant participant-head" data-participant="MetaFile"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108.8216" x="1135.0341" y="86.9659">meta/&lt;key&gt;.json</text><path d="M1174.4449,36 C1174.4449,26 1192.4449,26 1192.4449,26 C1192.4449,26 1210.4449,26 1210.4449,36 L1210.4449,62 C1210.4449,72 1192.4449,72 1192.4449,72 C1192.4449,72 1174.4449,72 1174.4449,62 L1174.4449,36" fill="#FEFECE" filter="url(#fzy2av3yoq3n2)" style="stroke:#A80036;stroke-width:1;"/><path d="M1174.4449,36 C1174.4449,46 1192.4449,46 1192.4449,46 C1192.4449,46 1210.4449,46 1210.4449,36" fill="none" style="stroke:#A80036;stroke-width:1;"/></g><g class="participant participant-tail" data-participant="MetaFile"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108.8216" x="1135.0341" y="3479.7173">meta/&lt;key&gt;.json</text><path d="M1174.4449,3493.8193 C1174.4449,3483.8193 1192.4449,3483.8193 1192.4449,3483.8193 C1192.4449,3483.8193 1210.4449,3483.8193 1210.4449,3493.8193 L1210.4449,3519.8193 C1210.4449,3529.8193 1192.4449,3529.8193 1192.4449,3529.8193 C1192.4449,3529.8193 1174.4449,3529.8193 1174.4449,3519.8193 L1174.4449,3493.8193" fill="#FEFECE" filter="url(#fzy2av3yoq3n2)" style="stroke:#A80036;stroke-width:1;"/><path d="M1174.4449,3493.8193 C1174.4449,3503.8193 1192.4449,3503.8193 1192.4449,3503.8193 C1192.4449,3503.8193 1210.4449,3503.8193 1210.4449,3493.8193" fill="none" style="stroke:#A80036;stroke-width:1;"/></g><g class="participant participant-head" data-participant="StateData"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110.8796" x="1259.8557" y="86.9659">state/&lt;key&gt;/data</text><path d="M1300.2954,36 C1300.2954,26 1318.2954,26 1318.2954,26 C1318.2954,26 1336.2954,26 1336.2954,36 L1336.2954,62 C1336.2954,72 1318.2954,72 1318.2954,72 C1318.2954,72 1300.2954,72 1300.2954,62 L1300.2954,36" fill="#FEFECE" filter="url(#fzy2av3yoq3n2)" style="stroke:#A80036;stroke-width:1;"/><path d="M1300.2954,36 C1300.2954,46 1318.2954,46 1318.2954,46 C1318.2954,46 1336.2954,46 1336.2954,36" fill="none" style="stroke:#A80036;stroke-width:1;"/></g><g class="participant participant-tail" data-participant="StateData"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110.8796" x="1259.8557" y="3479.7173">state/&lt;key&gt;/data</text><path d="M1300.2954,3493.8193 C1300.2954,3483.8193 1318.2954,3483.8193 1318.2954,3483.8193 C1318.2954,3483.8193 1336.2954,3483.8193 1336.2954,3493.8193 L1336.2954,3519.8193 C1336.2954,3529.8193 1318.2954,3529.8193 1318.2954,3529.8193 C1318.2954,3529.8193 1300.2954,3529.8193 1300.2954,3519.8193 L1300.2954,3493.8193" fill="#FEFECE" filter="url(#fzy2av3yoq3n2)" style="stroke:#A80036;stroke-width:1;"/><path d="M1300.2954,3493.8193 C1300.2954,3503.8193 1318.2954,3503.8193 1318.2954,3503.8193 C1318.2954,3503.8193 1336.2954,3503.8193 1336.2954,3493.8193" fill="none" style="stroke:#A80036;stroke-width:1;"/></g><g class="participant participant-head" data-participant="StateInfo"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="138.2495" x="1386.7352" y="86.9659">state/&lt;key&gt;/info.json</text><path d="M1440.86,36 C1440.86,26 1458.86,26 1458.86,26 C1458.86,26 1476.86,26 1476.86,36 L1476.86,62 C1476.86,72 1458.86,72 1458.86,72 C1458.86,72 1440.86,72 1440.86,62 L1440.86,36" fill="#FEFECE" filter="url(#fzy2av3yoq3n2)" style="stroke:#A80036;stroke-width:1;"/><path d="M1440.86,36 C1440.86,46 1458.86,46 1458.86,46 C1458.86,46 1476.86,46 1476.86,36" fill="none" style="stroke:#A80036;stroke-width:1;"/></g><g class="participant participant-tail" data-participant="StateInfo"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="138.2495" x="1386.7352" y="3479.7173">state/&lt;key&gt;/info.json</text><path d="M1440.86,3493.8193 C1440.86,3483.8193 1458.86,3483.8193 1458.86,3483.8193 C1458.86,3483.8193 1476.86,3483.8193 1476.86,3493.8193 L1476.86,3519.8193 C1476.86,3529.8193 1458.86,3529.8193 1458.86,3529.8193 C1458.86,3529.8193 1440.86,3529.8193 1440.86,3519.8193 L1440.86,3493.8193" fill="#FEFECE" filter="url(#fzy2av3yoq3n2)" style="stroke:#A80036;stroke-width:1;"/><path d="M1440.86,3493.8193 C1440.86,3503.8193 1458.86,3503.8193 1458.86,3503.8193 C1458.86,3503.8193 1476.86,3503.8193 1476.86,3493.8193" fill="none" style="stroke:#A80036;stroke-width:1;"/></g><g class="participant participant-head" data-participant="TmpDir"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="48.3978" x="1540.9847" y="86.9659">tmp dir</text><path d="M1550.1836,36 C1550.1836,26 1568.1836,26 1568.1836,26 C1568.1836,26 1586.1836,26 1586.1836,36 L1586.1836,62 C1586.1836,72 1568.1836,72 1568.1836,72 C1568.1836,72 1550.1836,72 1550.1836,62 L1550.1836,36" fill="#FEFECE" filter="url(#fzy2av3yoq3n2)" style="stroke:#A80036;stroke-width:1;"/><path d="M1550.1836,36 C1550.1836,46 1568.1836,46 1568.1836,46 C1568.1836,46 1586.1836,46 1586.1836,36" fill="none" style="stroke:#A80036;stroke-width:1;"/></g><g class="participant participant-tail" data-participant="TmpDir"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="48.3978" x="1540.9847" y="3479.7173">tmp dir</text><path d="M1550.1836,3493.8193 C1550.1836,3483.8193 1568.1836,3483.8193 1568.1836,3483.8193 C1568.1836,3483.8193 1586.1836,3483.8193 1586.1836,3493.8193 L1586.1836,3519.8193 C1586.1836,3529.8193 1568.1836,3529.8193 1568.1836,3529.8193 C1568.1836,3529.8193 1550.1836,3529.8193 1550.1836,3519.8193 L1550.1836,3493.8193" fill="#FEFECE" filter="url(#fzy2av3yoq3n2)" style="stroke:#A80036;stroke-width:1;"/><path d="M1550.1836,3493.8193 C1550.1836,3503.8193 1568.1836,3503.8193 1568.1836,3503.8193 C1568.1836,3503.8193 1586.1836,3503.8193 1586.1836,3493.8193" fill="none" style="stroke:#A80036;stroke-width:1;"/></g><rect fill="#EEEEEE" filter="url(#fzy2av3yoq3n2)" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1600.3825" x="0" y="122.9209"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1600.3825" y1="122.9209" y2="122.9209"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1600.3825" y1="125.9209" y2="125.9209"/><rect fill="#EEEEEE" filter="url(#fzy2av3yoq3n2)" height="25.706" style="stroke:#000000;stroke-width:2;" width="67.352" x="766.5152" y="111.0679"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="49.972" x="772.5152" y="128.9649">Acquire</text><g class="message" data-participant-1="Client" data-participant-2="Handler"><polygon fill="#A80036" points="323.8623,166.4799,333.8623,170.4799,323.8623,174.4799,327.8623,170.4799" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="26.8369" x2="329.8623" y1="170.4799" y2="170.4799"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.0921" x="33.8369" y="164.6709">POST /v1/acquire</text></g><g class="message" data-participant-1="Handler" data-participant-2="Disk"><polygon fill="#A80036" points="720.3668,198.186,730.3668,202.186,720.3668,206.186,724.3668,202.186" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="335.8623" x2="726.3668" y1="202.186" y2="202.186"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89.7781" x="342.8623" y="196.377">LoadMeta(key)</text></g><g class="message" data-participant-1="Disk" data-participant-2="Global"><polygon fill="#A80036" points="853.6449,229.892,863.6449,233.892,853.6449,237.892,857.6449,233.892" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="859.6449" y1="233.892" y2="233.892"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.2781" x="739.3668" y="228.083">lock(encoded key)</text></g><g class="message" data-participant-1="Global" data-participant-2="Disk"><polygon fill="#A80036" points="743.3668,261.598,733.3668,265.598,743.3668,269.598,739.3668,265.598" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:2,2;" x1="737.3668" x2="864.6449" y1="265.598" y2="265.598"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="14.807" x="749.3668" y="259.789">ok</text></g><g class="message" data-participant-1="Disk" data-participant-2="KeyMutex"><polygon fill="#A80036" points="972.7495,293.304,982.7495,297.304,972.7495,301.304,976.7495,297.304" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="978.7495" y1="297.304" y2="297.304"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53.105" x="739.3668" y="291.495">lock(key)</text></g><g class="message" data-participant-1="KeyMutex" data-participant-2="Disk"><polygon fill="#A80036" points="743.3668,325.01,733.3668,329.01,743.3668,333.01,739.3668,329.01" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:2,2;" x1="737.3668" x2="983.7495" y1="329.01" y2="329.01"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="14.807" x="749.3668" y="323.201">ok</text></g><g class="message" data-participant-1="Disk" data-participant-2="FileLock"><polygon fill="#A80036" points="1076.0202,356.716,1086.0202,360.716,1076.0202,364.716,1080.0202,360.716" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="1082.0202" y1="360.716" y2="360.716"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.9661" x="739.3668" y="354.907">flock(lock file)</text></g><g class="message" data-participant-1="FileLock" data-participant-2="Disk"><polygon fill="#A80036" points="743.3668,388.4221,733.3668,392.4221,743.3668,396.4221,739.3668,392.4221" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:2,2;" x1="737.3668" x2="1087.0202" y1="392.4221" y2="392.4221"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="14.807" x="749.3668" y="386.6131">ok</text></g><g class="message" data-participant-1="Disk" data-participant-2="MetaFile"><polygon fill="#A80036" points="1180.4449,420.1281,1190.4449,424.1281,1180.4449,428.1281,1184.4449,424.1281" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="1186.4449" y1="424.1281" y2="424.1281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62.088" x="739.3668" y="418.3191">read JSON</text></g><g class="message" data-participant-1="MetaFile" data-participant-2="Disk"><polygon fill="#A80036" points="743.3668,451.8341,733.3668,455.8341,743.3668,459.8341,739.3668,455.8341" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:2,2;" x1="737.3668" x2="1191.4449" y1="455.8341" y2="455.8341"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179.8552" x="749.3668" y="450.0251">meta + etag (or ErrNotFound)</text></g><g class="message" data-participant-1="Disk" data-participant-2="FileLock"><polygon fill="#A80036" points="1076.0202,483.5401,1086.0202,487.5401,1076.0202,491.5401,1080.0202,487.5401" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="1082.0202" y1="487.5401" y2="487.5401"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40.469" x="739.3668" y="481.7311">unlock</text></g><g class="message" data-participant-1="Disk" data-participant-2="KeyMutex"><polygon fill="#A80036" points="972.7495,515.2461,982.7495,519.2461,972.7495,523.2461,976.7495,519.2461" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="978.7495" y1="519.2461" y2="519.2461"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40.469" x="739.3668" y="513.4371">unlock</text></g><g class="message" data-participant-1="Disk" data-participant-2="Global"><polygon fill="#A80036" points="853.6449,546.9521,863.6449,550.9521,853.6449,554.9521,857.6449,550.9521" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="859.6449" y1="550.9521" y2="550.9521"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40.469" x="739.3668" y="545.1431">unlock</text></g><g class="message" data-participant-1="Disk" data-participant-2="Handler"><polygon fill="#A80036" points="346.8623,578.6582,336.8623,582.6582,346.8623,586.6582,342.8623,582.6582" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:2,2;" x1="340.8623" x2="731.3668" y1="582.6582" y2="582.6582"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110.2271" x="352.8623" y="576.8492">meta + meta_etag</text></g><g class="message" data-participant-1="Handler" data-participant-2="Handler"><line style="stroke:#A80036;stroke-width:1;" x1="335.8623" x2="377.8623" y1="614.3642" y2="614.3642"/><line style="stroke:#A80036;stroke-width:1;" x1="377.8623" x2="377.8623" y1="614.3642" y2="627.3642"/><line style="stroke:#A80036;stroke-width:1;" x1="336.8623" x2="377.8623" y1="627.3642" y2="627.3642"/><polygon fill="#A80036" points="346.8623,623.3642,336.8623,627.3642,346.8623,631.3642,342.8623,627.3642" style="stroke:#A80036;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160.8361" x="342.8623" y="608.5552">lease_id, fencing := prev+1</text></g><g class="message" data-participant-1="Handler" data-participant-2="Disk"><polygon fill="#A80036" points="720.3668,655.0702,730.3668,659.0702,720.3668,663.0702,724.3668,659.0702" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="335.8623" x2="726.3668" y1="659.0702" y2="659.0702"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157.5601" x="342.8623" y="653.2612">StoreMeta(updated lease)</text></g><g class="message" data-participant-1="Disk" data-participant-2="Global"><polygon fill="#A80036" points="853.6449,686.7762,863.6449,690.7762,853.6449,694.7762,857.6449,690.7762" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="859.6449" y1="690.7762" y2="690.7762"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.401" x="739.3668" y="684.9672">lock</text></g><g class="message" data-participant-1="Disk" data-participant-2="KeyMutex"><polygon fill="#A80036" points="972.7495,718.4822,982.7495,722.4822,972.7495,726.4822,976.7495,722.4822" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="978.7495" y1="722.4822" y2="722.4822"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.401" x="739.3668" y="716.6732">lock</text></g><g class="message" data-participant-1="Disk" data-participant-2="FileLock"><polygon fill="#A80036" points="1076.0202,750.1882,1086.0202,754.1882,1076.0202,758.1882,1080.0202,754.1882" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="1082.0202" y1="754.1882" y2="754.1882"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="28.873" x="739.3668" y="748.3792">flock</text></g><g class="message" data-participant-1="Disk" data-participant-2="MetaFile"><polygon fill="#A80036" points="1180.4449,781.8943,1190.4449,785.8943,1180.4449,789.8943,1184.4449,785.8943" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="1186.4449" y1="785.8943" y2="785.8943"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193.4662" x="739.3668" y="780.0853">write temp JSON, fsync, rename</text></g><g class="message" data-participant-1="MetaFile" data-participant-2="Disk"><polygon fill="#A80036" points="743.3668,813.6003,733.3668,817.6003,743.3668,821.6003,739.3668,817.6003" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:2,2;" x1="737.3668" x2="1191.4449" y1="817.6003" y2="817.6003"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.9141" x="749.3668" y="811.7913">new_meta_etag</text></g><g class="message" data-participant-1="Disk" data-participant-2="FileLock"><polygon fill="#A80036" points="1076.0202,845.3063,1086.0202,849.3063,1076.0202,853.3063,1080.0202,849.3063" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="1082.0202" y1="849.3063" y2="849.3063"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40.469" x="739.3668" y="843.4973">unlock</text></g><g class="message" data-participant-1="Disk" data-participant-2="KeyMutex"><polygon fill="#A80036" points="972.7495,877.0123,982.7495,881.0123,972.7495,885.0123,976.7495,881.0123" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="978.7495" y1="881.0123" y2="881.0123"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40.469" x="739.3668" y="875.2033">unlock</text></g><g class="message" data-participant-1="Disk" data-participant-2="Global"><polygon fill="#A80036" points="853.6449,908.7183,863.6449,912.7183,853.6449,916.7183,857.6449,912.7183" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="859.6449" y1="912.7183" y2="912.7183"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40.469" x="739.3668" y="906.9093">unlock</text></g><g class="message" data-participant-1="Disk" data-participant-2="Handler"><polygon fill="#A80036" points="346.8623,940.4243,336.8623,944.4243,346.8623,948.4243,342.8623,944.4243" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:2,2;" x1="340.8623" x2="731.3668" y1="944.4243" y2="944.4243"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.9141" x="352.8623" y="938.6153">new_meta_etag</text></g><g class="message" data-participant-1="Handler" data-participant-2="Cache"><polygon fill="#A80036" points="498.6984,972.1304,508.6984,976.1304,498.6984,980.1304,502.6984,976.1304" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="335.8623" x2="504.6984" y1="976.1304" y2="976.1304"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94.8871" x="342.8623" y="970.3214">cache snapshot</text></g><g class="message" data-participant-1="Handler" data-participant-2="Client"><polygon fill="#A80036" points="37.8369,1021.5424,27.8369,1025.5424,37.8369,1029.5424,33.8369,1025.5424" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:2,2;" x1="31.8369" x2="334.8623" y1="1025.5424" y2="1025.5424"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.4171" x="43.8369" y="1002.0274">200 AcquireResponse</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101.1271" x="43.8369" y="1019.7334">X-Fencing-Token</text></g><rect fill="#EEEEEE" filter="url(#fzy2av3yoq3n2)" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1600.3825" x="0" y="1055.3954"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1600.3825" y1="1055.3954" y2="1055.3954"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1600.3825" y1="1058.3954" y2="1058.3954"/><rect fill="#EEEEEE" filter="url(#fzy2av3yoq3n2)" height="25.706" style="stroke:#000000;stroke-width:2;" width="81.5871" x="759.3977" y="1043.5424"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="64.207" x="765.3977" y="1061.4394">KeepAlive</text><g class="message" data-participant-1="Client" data-participant-2="Handler"><polygon fill="#A80036" points="323.8623,1116.6604,333.8623,1120.6604,323.8623,1124.6604,327.8623,1120.6604" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="26.8369" x2="329.8623" y1="1120.6604" y2="1120.6604"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117.0131" x="33.8369" y="1097.1454">POST /v1/keepalive</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101.1271" x="33.8369" y="1114.8514">X-Fencing-Token</text></g><g class="message" data-participant-1="Handler" data-participant-2="Cache"><polygon fill="#A80036" points="498.6984,1148.3665,508.6984,1152.3665,498.6984,1156.3665,502.6984,1152.3665" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="335.8623" x2="504.6984" y1="1152.3665" y2="1152.3665"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76.9731" x="342.8623" y="1146.5575">lookup lease</text></g><path d="M271.4464,1167.3665 L333.9054,1167.3665 L333.9054,1177.0725 L323.9054,1187.0725 L271.4464,1187.0725 L271.4464,1167.3665" fill="#EEEEEE" style="stroke:#000000;stroke-width:1;"/><rect fill="none" height="143.0818" style="stroke:#000000;stroke-width:2;" width="512.4422" x="271.4464" y="1167.3665"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.459" x="286.4464" y="1182.2635">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="58.5306" x="348.9054" y="1181.1254">[Cache hit]</text><g class="message" data-participant-1="Cache" data-participant-2="Handler"><polygon fill="#A80036" points="346.8623,1206.7785,336.8623,1210.7785,346.8623,1214.7785,342.8623,1210.7785" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:2,2;" x1="340.8623" x2="509.6984" y1="1210.7785" y2="1210.7785"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72.9821" x="352.8623" y="1204.9695">meta + etag</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="271.4464" x2="783.8886" y1="1219.7785" y2="1219.7785"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="68.2655" x="276.4464" y="1231.5374">[Cache miss]</text><g class="message" data-participant-1="Handler" data-participant-2="Disk"><polygon fill="#A80036" points="720.3668,1255.4664,730.3668,1259.4664,720.3668,1263.4664,724.3668,1259.4664" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="335.8623" x2="726.3668" y1="1259.4664" y2="1259.4664"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89.7781" x="342.8623" y="1253.6574">LoadMeta(key)</text></g><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="126.8181" x="734.1012" y="1293.2253">(same locking sequence)</text><g class="message" data-participant-1="Handler" data-participant-2="Disk"><polygon fill="#A80036" points="720.3668,1337.1543,730.3668,1341.1543,720.3668,1345.1543,724.3668,1341.1543" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="335.8623" x2="726.3668" y1="1341.1543" y2="1341.1543"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188.2662" x="342.8623" y="1335.3453">StoreMeta(updated expires_at)</text></g><g class="message" data-participant-1="Disk" data-participant-2="Global"><polygon fill="#A80036" points="853.6449,1368.8603,863.6449,1372.8603,853.6449,1376.8603,857.6449,1372.8603" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="859.6449" y1="1372.8603" y2="1372.8603"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.401" x="739.3668" y="1367.0513">lock</text></g><g class="message" data-participant-1="Disk" data-participant-2="KeyMutex"><polygon fill="#A80036" points="972.7495,1400.5663,982.7495,1404.5663,972.7495,1408.5663,976.7495,1404.5663" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="978.7495" y1="1404.5663" y2="1404.5663"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.401" x="739.3668" y="1398.7573">lock</text></g><g class="message" data-participant-1="Disk" data-participant-2="FileLock"><polygon fill="#A80036" points="1076.0202,1432.2724,1086.0202,1436.2724,1076.0202,1440.2724,1080.0202,1436.2724" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="1082.0202" y1="1436.2724" y2="1436.2724"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="28.873" x="739.3668" y="1430.4634">flock</text></g><g class="message" data-participant-1="Disk" data-participant-2="MetaFile"><polygon fill="#A80036" points="1180.4449,1463.9784,1190.4449,1467.9784,1180.4449,1471.9784,1184.4449,1467.9784" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="1186.4449" y1="1467.9784" y2="1467.9784"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65.065" x="739.3668" y="1462.1694">write JSON</text></g><g class="message" data-participant-1="Disk" data-participant-2="FileLock"><polygon fill="#A80036" points="1076.0202,1495.6844,1086.0202,1499.6844,1076.0202,1503.6844,1080.0202,1499.6844" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="1082.0202" y1="1499.6844" y2="1499.6844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40.469" x="739.3668" y="1493.8754">unlock</text></g><g class="message" data-participant-1="Disk" data-participant-2="KeyMutex"><polygon fill="#A80036" points="972.7495,1527.3904,982.7495,1531.3904,972.7495,1535.3904,976.7495,1531.3904" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="978.7495" y1="1531.3904" y2="1531.3904"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40.469" x="739.3668" y="1525.5814">unlock</text></g><g class="message" data-participant-1="Disk" data-participant-2="Global"><polygon fill="#A80036" points="853.6449,1559.0964,863.6449,1563.0964,853.6449,1567.0964,857.6449,1563.0964" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="859.6449" y1="1563.0964" y2="1563.0964"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40.469" x="739.3668" y="1557.2874">unlock</text></g><g class="message" data-participant-1="Disk" data-participant-2="Handler"><polygon fill="#A80036" points="346.8623,1590.8024,336.8623,1594.8024,346.8623,1598.8024,342.8623,1594.8024" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:2,2;" x1="340.8623" x2="731.3668" y1="1594.8024" y2="1594.8024"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.9141" x="352.8623" y="1588.9934">new_meta_etag</text></g><g class="message" data-participant-1="Handler" data-participant-2="Cache"><polygon fill="#A80036" points="498.6984,1622.5085,508.6984,1626.5085,498.6984,1630.5085,502.6984,1626.5085" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="335.8623" x2="504.6984" y1="1626.5085" y2="1626.5085"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.8831" x="342.8623" y="1620.6995">refresh snapshot</text></g><g class="message" data-participant-1="Handler" data-participant-2="Client"><polygon fill="#A80036" points="37.8369,1654.2145,27.8369,1658.2145,37.8369,1662.2145,33.8369,1658.2145" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:2,2;" x1="31.8369" x2="334.8623" y1="1658.2145" y2="1658.2145"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85.3451" x="43.8369" y="1652.4055">200 KeepAlive</text></g><rect fill="#EEEEEE" filter="url(#fzy2av3yoq3n2)" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1600.3825" x="0" y="1688.0675"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1600.3825" y1="1688.0675" y2="1688.0675"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1600.3825" y1="1691.0675" y2="1691.0675"/><rect fill="#EEEEEE" filter="url(#fzy2av3yoq3n2)" height="25.706" style="stroke:#000000;stroke-width:2;" width="74.099" x="763.1417" y="1676.2145"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="56.719" x="769.1417" y="1694.1115">GetState</text><g class="message" data-participant-1="Client" data-participant-2="Handler"><polygon fill="#A80036" points="323.8623,1731.6265,333.8623,1735.6265,323.8623,1739.6265,327.8623,1735.6265" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="26.8369" x2="329.8623" y1="1735.6265" y2="1735.6265"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.5051" x="33.8369" y="1729.8175">POST /v1/get_state</text></g><g class="message" data-participant-1="Handler" data-participant-2="Disk"><polygon fill="#A80036" points="720.3668,1763.3325,730.3668,1767.3325,720.3668,1771.3325,724.3668,1767.3325" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="335.8623" x2="726.3668" y1="1767.3325" y2="1767.3325"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90.5581" x="342.8623" y="1761.5235">ReadState(key)</text></g><g class="message" data-participant-1="Disk" data-participant-2="Global"><polygon fill="#A80036" points="853.6449,1795.0385,863.6449,1799.0385,853.6449,1803.0385,857.6449,1799.0385" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="859.6449" y1="1799.0385" y2="1799.0385"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.401" x="739.3668" y="1793.2295">lock</text></g><g class="message" data-participant-1="Disk" data-participant-2="KeyMutex"><polygon fill="#A80036" points="972.7495,1826.7446,982.7495,1830.7446,972.7495,1834.7446,976.7495,1830.7446" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="978.7495" y1="1830.7446" y2="1830.7446"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.401" x="739.3668" y="1824.9355">lock</text></g><g class="message" data-participant-1="Disk" data-participant-2="FileLock"><polygon fill="#A80036" points="1076.0202,1858.4506,1086.0202,1862.4506,1076.0202,1866.4506,1080.0202,1862.4506" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="1082.0202" y1="1862.4506" y2="1862.4506"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="28.873" x="739.3668" y="1856.6416">flock</text></g><g class="message" data-participant-1="Disk" data-participant-2="StateInfo"><polygon fill="#A80036" points="1446.86,1890.1566,1456.86,1894.1566,1446.86,1898.1566,1450.86,1894.1566" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="1452.86" y1="1894.1566" y2="1894.1566"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84.0581" x="739.3668" y="1888.3476">read info.json</text></g><g class="message" data-participant-1="Disk" data-participant-2="StateData"><polygon fill="#A80036" points="1306.2954,1921.8626,1316.2954,1925.8626,1306.2954,1929.8626,1310.2954,1925.8626" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="1312.2954" y1="1925.8626" y2="1925.8626"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114.5561" x="739.3668" y="1920.0536">open file read-only</text></g><g class="message" data-participant-1="Disk" data-participant-2="FileLock"><polygon fill="#A80036" points="1076.0202,1953.5686,1086.0202,1957.5686,1076.0202,1961.5686,1080.0202,1957.5686" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="1082.0202" y1="1957.5686" y2="1957.5686"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40.469" x="739.3668" y="1951.7596">unlock</text></g><g class="message" data-participant-1="Disk" data-participant-2="KeyMutex"><polygon fill="#A80036" points="972.7495,1985.2746,982.7495,1989.2746,972.7495,1993.2746,976.7495,1989.2746" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="978.7495" y1="1989.2746" y2="1989.2746"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40.469" x="739.3668" y="1983.4656">unlock</text></g><g class="message" data-participant-1="Disk" data-participant-2="Global"><polygon fill="#A80036" points="853.6449,2016.9807,863.6449,2020.9807,853.6449,2024.9807,857.6449,2020.9807" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="859.6449" y1="2020.9807" y2="2020.9807"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40.469" x="739.3668" y="2015.1716">unlock</text></g><g class="message" data-participant-1="Disk" data-participant-2="Handler"><polygon fill="#A80036" points="346.8623,2048.6867,336.8623,2052.6867,346.8623,2056.6867,342.8623,2052.6867" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:2,2;" x1="340.8623" x2="731.3668" y1="2052.6867" y2="2052.6867"/><ellipse cx="358.3623" cy="2043.1867" fill="#000000" rx="2.5" ry="2.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76.2841" x="364.8623" y="2046.8777">os.File + info</text></g><g class="message" data-participant-1="Handler" data-participant-2="Client"><polygon fill="#A80036" points="37.8369,2098.0987,27.8369,2102.0987,37.8369,2106.0987,33.8369,2102.0987" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:2,2;" x1="31.8369" x2="334.8623" y1="2102.0987" y2="2102.0987"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68.757" x="43.8369" y="2078.5837">200 stream</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="285.0253" x="43.8369" y="2096.2897">headers: ETag, X-Key-Version, X-Fencing-Token</text></g><rect fill="#EEEEEE" filter="url(#fzy2av3yoq3n2)" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1600.3825" x="0" y="2131.9517"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1600.3825" y1="2131.9517" y2="2131.9517"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1600.3825" y1="2134.9517" y2="2134.9517"/><rect fill="#EEEEEE" filter="url(#fzy2av3yoq3n2)" height="25.706" style="stroke:#000000;stroke-width:2;" width="98.8251" x="750.7787" y="2120.0987"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="81.4451" x="756.7787" y="2137.9957">UpdateState</text><g class="message" data-participant-1="Client" data-participant-2="Handler"><polygon fill="#A80036" points="323.8623,2175.5107,333.8623,2179.5107,323.8623,2183.5107,327.8623,2179.5107" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="26.8369" x2="329.8623" y1="2179.5107" y2="2179.5107"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138.8271" x="33.8369" y="2173.7017">POST /v1/update_state</text></g><g class="message" data-participant-1="Handler" data-participant-2="Spool"><polygon fill="#A80036" points="613.5961,2207.2168,623.5961,2211.2168,613.5961,2215.2168,617.5961,2211.2168" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="335.8623" x2="619.5961" y1="2211.2168" y2="2211.2168"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.3821" x="342.8623" y="2205.4077">write/compact JSON</text></g><g class="message" data-participant-1="Spool" data-participant-2="Handler"><polygon fill="#A80036" points="346.8623,2238.9228,336.8623,2242.9228,346.8623,2246.9228,342.8623,2242.9228" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:2,2;" x1="340.8623" x2="624.5961" y1="2242.9228" y2="2242.9228"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.8531" x="352.8623" y="2237.1138">io.ReadSeeker</text></g><g class="message" data-participant-1="Handler" data-participant-2="Disk"><polygon fill="#A80036" points="720.3668,2270.6288,730.3668,2274.6288,720.3668,2278.6288,724.3668,2274.6288" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="335.8623" x2="726.3668" y1="2274.6288" y2="2274.6288"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188.4352" x="342.8623" y="2268.8198">WriteState(key, expected_etag)</text></g><g class="message" data-participant-1="Disk" data-participant-2="Global"><polygon fill="#A80036" points="853.6449,2302.3348,863.6449,2306.3348,853.6449,2310.3348,857.6449,2306.3348" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="859.6449" y1="2306.3348" y2="2306.3348"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.401" x="739.3668" y="2300.5258">lock</text></g><g class="message" data-participant-1="Disk" data-participant-2="KeyMutex"><polygon fill="#A80036" points="972.7495,2334.0408,982.7495,2338.0408,972.7495,2342.0408,976.7495,2338.0408" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="978.7495" y1="2338.0408" y2="2338.0408"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.401" x="739.3668" y="2332.2318">lock</text></g><g class="message" data-participant-1="Disk" data-participant-2="FileLock"><polygon fill="#A80036" points="1076.0202,2365.7468,1086.0202,2369.7468,1076.0202,2373.7468,1080.0202,2369.7468" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="1082.0202" y1="2369.7468" y2="2369.7468"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="28.873" x="739.3668" y="2363.9378">flock</text></g><g class="message" data-participant-1="Disk" data-participant-2="TmpDir"><polygon fill="#A80036" points="1556.1836,2397.4529,1566.1836,2401.4529,1556.1836,2405.4529,1560.1836,2401.4529" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="1562.1836" y1="2401.4529" y2="2401.4529"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.7061" x="739.3668" y="2395.6438">create temp file</text></g><g class="message" data-participant-1="Handler" data-participant-2="Disk"><polygon fill="#A80036" points="720.3668,2429.1589,730.3668,2433.1589,720.3668,2437.1589,724.3668,2433.1589" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="335.8623" x2="726.3668" y1="2433.1589" y2="2433.1589"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185.5492" x="342.8623" y="2427.3499">stream body -&gt; temp + sha256</text></g><g class="message" data-participant-1="Disk" data-participant-2="TmpDir"><polygon fill="#A80036" points="1556.1836,2460.8649,1566.1836,2464.8649,1556.1836,2468.8649,1560.1836,2464.8649" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="1562.1836" y1="2464.8649" y2="2464.8649"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114.4521" x="739.3668" y="2459.0559">fsync &amp; close temp</text></g><g class="message" data-participant-1="Disk" data-participant-2="StateData"><polygon fill="#A80036" points="1306.2954,2492.5709,1316.2954,2496.5709,1306.2954,2500.5709,1310.2954,2496.5709" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="1312.2954" y1="2496.5709" y2="2496.5709"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128.7261" x="739.3668" y="2490.7619">rename temp -&gt; data</text></g><g class="message" data-participant-1="Disk" data-participant-2="StateInfo"><polygon fill="#A80036" points="1446.86,2524.2769,1456.86,2528.2769,1446.86,2532.2769,1450.86,2528.2769" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="1452.86" y1="2528.2769" y2="2528.2769"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87.0351" x="739.3668" y="2522.4679">write info.json</text></g><g class="message" data-participant-1="Disk" data-participant-2="FileLock"><polygon fill="#A80036" points="1076.0202,2555.9829,1086.0202,2559.9829,1076.0202,2563.9829,1080.0202,2559.9829" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="1082.0202" y1="2559.9829" y2="2559.9829"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40.469" x="739.3668" y="2554.1739">unlock</text></g><g class="message" data-participant-1="Disk" data-participant-2="KeyMutex"><polygon fill="#A80036" points="972.7495,2587.6889,982.7495,2591.6889,972.7495,2595.6889,976.7495,2591.6889" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="978.7495" y1="2591.6889" y2="2591.6889"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40.469" x="739.3668" y="2585.8799">unlock</text></g><g class="message" data-participant-1="Disk" data-participant-2="Global"><polygon fill="#A80036" points="853.6449,2619.395,863.6449,2623.395,853.6449,2627.395,857.6449,2623.395" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="859.6449" y1="2623.395" y2="2623.395"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40.469" x="739.3668" y="2617.586">unlock</text></g><g class="message" data-participant-1="Disk" data-participant-2="Handler"><polygon fill="#A80036" points="346.8623,2651.101,336.8623,2655.101,346.8623,2659.101,342.8623,2655.101" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:2,2;" x1="340.8623" x2="731.3668" y1="2655.101" y2="2655.101"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.7521" x="352.8623" y="2649.292">new_state_etag + bytes</text></g><g class="message" data-participant-1="Handler" data-participant-2="Disk"><polygon fill="#A80036" points="720.3668,2682.807,730.3668,2686.807,720.3668,2690.807,724.3668,2686.807" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="335.8623" x2="726.3668" y1="2686.807" y2="2686.807"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201.1492" x="342.8623" y="2680.998">StoreMeta(version+1, state_etag)</text></g><g class="message" data-participant-1="Disk" data-participant-2="Global"><polygon fill="#A80036" points="853.6449,2714.513,863.6449,2718.513,853.6449,2722.513,857.6449,2718.513" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="859.6449" y1="2718.513" y2="2718.513"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.401" x="739.3668" y="2712.704">lock</text></g><g class="message" data-participant-1="Disk" data-participant-2="KeyMutex"><polygon fill="#A80036" points="972.7495,2746.219,982.7495,2750.219,972.7495,2754.219,976.7495,2750.219" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="978.7495" y1="2750.219" y2="2750.219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.401" x="739.3668" y="2744.41">lock</text></g><g class="message" data-participant-1="Disk" data-participant-2="FileLock"><polygon fill="#A80036" points="1076.0202,2777.925,1086.0202,2781.925,1076.0202,2785.925,1080.0202,2781.925" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="1082.0202" y1="2781.925" y2="2781.925"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="28.873" x="739.3668" y="2776.116">flock</text></g><g class="message" data-participant-1="Disk" data-participant-2="MetaFile"><polygon fill="#A80036" points="1180.4449,2809.6311,1190.4449,2813.6311,1180.4449,2817.6311,1184.4449,2813.6311" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="1186.4449" y1="2813.6311" y2="2813.6311"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65.065" x="739.3668" y="2807.8221">write JSON</text></g><g class="message" data-participant-1="Disk" data-participant-2="FileLock"><polygon fill="#A80036" points="1076.0202,2841.3371,1086.0202,2845.3371,1076.0202,2849.3371,1080.0202,2845.3371" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="1082.0202" y1="2845.3371" y2="2845.3371"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40.469" x="739.3668" y="2839.5281">unlock</text></g><g class="message" data-participant-1="Disk" data-participant-2="KeyMutex"><polygon fill="#A80036" points="972.7495,2873.0431,982.7495,2877.0431,972.7495,2881.0431,976.7495,2877.0431" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="978.7495" y1="2877.0431" y2="2877.0431"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40.469" x="739.3668" y="2871.2341">unlock</text></g><g class="message" data-participant-1="Disk" data-participant-2="Global"><polygon fill="#A80036" points="853.6449,2904.7491,863.6449,2908.7491,853.6449,2912.7491,857.6449,2908.7491" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="859.6449" y1="2908.7491" y2="2908.7491"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40.469" x="739.3668" y="2902.9401">unlock</text></g><g class="message" data-participant-1="Disk" data-participant-2="Handler"><polygon fill="#A80036" points="346.8623,2936.4551,336.8623,2940.4551,346.8623,2944.4551,342.8623,2940.4551" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:2,2;" x1="340.8623" x2="731.3668" y1="2940.4551" y2="2940.4551"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.9141" x="352.8623" y="2934.6461">new_meta_etag</text></g><g class="message" data-participant-1="Handler" data-participant-2="Cache"><polygon fill="#A80036" points="498.6984,2968.1611,508.6984,2972.1611,498.6984,2976.1611,502.6984,2972.1611" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="335.8623" x2="504.6984" y1="2972.1611" y2="2972.1611"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.0901" x="342.8623" y="2966.3521">update snapshot</text></g><g class="message" data-participant-1="Handler" data-participant-2="Client"><polygon fill="#A80036" points="37.8369,3017.5732,27.8369,3021.5732,37.8369,3025.5732,33.8369,3021.5732" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:2,2;" x1="31.8369" x2="334.8623" y1="3021.5732" y2="3021.5732"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="252.9932" x="43.8369" y="2998.0582">200 {new_version, new_state_etag, bytes}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="285.0253" x="43.8369" y="3015.7642">headers: ETag, X-Key-Version, X-Fencing-Token</text></g><rect fill="#EEEEEE" filter="url(#fzy2av3yoq3n2)" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1600.3825" x="0" y="3051.4262"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1600.3825" y1="3051.4262" y2="3051.4262"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1600.3825" y1="3054.4262" y2="3054.4262"/><rect fill="#EEEEEE" filter="url(#fzy2av3yoq3n2)" height="25.706" style="stroke:#000000;stroke-width:2;" width="67.287" x="766.5477" y="3039.5732"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="49.907" x="772.5477" y="3057.4702">Release</text><g class="message" data-participant-1="Client" data-participant-2="Handler"><polygon fill="#A80036" points="323.8623,3094.9852,333.8623,3098.9852,323.8623,3102.9852,327.8623,3098.9852" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="26.8369" x2="329.8623" y1="3098.9852" y2="3098.9852"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.7141" x="33.8369" y="3093.1762">POST /v1/release</text></g><g class="message" data-participant-1="Handler" data-participant-2="Disk"><polygon fill="#A80036" points="720.3668,3126.6912,730.3668,3130.6912,720.3668,3134.6912,724.3668,3130.6912" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="335.8623" x2="726.3668" y1="3130.6912" y2="3130.6912"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125.0211" x="342.8623" y="3124.8822">StoreMeta(lease=nil)</text></g><g class="message" data-participant-1="Disk" data-participant-2="Global"><polygon fill="#A80036" points="853.6449,3158.3972,863.6449,3162.3972,853.6449,3166.3972,857.6449,3162.3972" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="859.6449" y1="3162.3972" y2="3162.3972"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.401" x="739.3668" y="3156.5882">lock</text></g><g class="message" data-participant-1="Disk" data-participant-2="KeyMutex"><polygon fill="#A80036" points="972.7495,3190.1033,982.7495,3194.1033,972.7495,3198.1033,976.7495,3194.1033" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="978.7495" y1="3194.1033" y2="3194.1033"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.401" x="739.3668" y="3188.2943">lock</text></g><g class="message" data-participant-1="Disk" data-participant-2="FileLock"><polygon fill="#A80036" points="1076.0202,3221.8093,1086.0202,3225.8093,1076.0202,3229.8093,1080.0202,3225.8093" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="1082.0202" y1="3225.8093" y2="3225.8093"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="28.873" x="739.3668" y="3220.0003">flock</text></g><g class="message" data-participant-1="Disk" data-participant-2="MetaFile"><polygon fill="#A80036" points="1180.4449,3253.5153,1190.4449,3257.5153,1180.4449,3261.5153,1184.4449,3257.5153" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="1186.4449" y1="3257.5153" y2="3257.5153"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65.065" x="739.3668" y="3251.7063">write JSON</text></g><g class="message" data-participant-1="Disk" data-participant-2="FileLock"><polygon fill="#A80036" points="1076.0202,3285.2213,1086.0202,3289.2213,1076.0202,3293.2213,1080.0202,3289.2213" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="1082.0202" y1="3289.2213" y2="3289.2213"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40.469" x="739.3668" y="3283.4123">unlock</text></g><g class="message" data-participant-1="Disk" data-participant-2="KeyMutex"><polygon fill="#A80036" points="972.7495,3316.9273,982.7495,3320.9273,972.7495,3324.9273,976.7495,3320.9273" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="978.7495" y1="3320.9273" y2="3320.9273"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40.469" x="739.3668" y="3315.1183">unlock</text></g><g class="message" data-participant-1="Disk" data-participant-2="Global"><polygon fill="#A80036" points="853.6449,3348.6333,863.6449,3352.6333,853.6449,3356.6333,857.6449,3352.6333" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="732.3668" x2="859.6449" y1="3352.6333" y2="3352.6333"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40.469" x="739.3668" y="3346.8243">unlock</text></g><g class="message" data-participant-1="Disk" data-participant-2="Handler"><polygon fill="#A80036" points="346.8623,3380.3394,336.8623,3384.3394,346.8623,3388.3394,342.8623,3384.3394" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:2,2;" x1="340.8623" x2="731.3668" y1="3384.3394" y2="3384.3394"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.9141" x="352.8623" y="3378.5304">new_meta_etag</text></g><g class="message" data-participant-1="Handler" data-participant-2="Cache"><polygon fill="#A80036" points="498.6984,3412.0454,508.6984,3416.0454,498.6984,3420.0454,502.6984,3416.0454" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;" x1="335.8623" x2="504.6984" y1="3416.0454" y2="3416.0454"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.142" x="342.8623" y="3410.2364">drop lease</text></g><g class="message" data-participant-1="Handler" data-participant-2="Client"><polygon fill="#A80036" points="37.8369,3443.7514,27.8369,3447.7514,37.8369,3451.7514,33.8369,3447.7514" style="stroke:#A80036;stroke-width:1;"/><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:2,2;" x1="31.8369" x2="334.8623" y1="3447.7514" y2="3447.7514"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116.7141" x="43.8369" y="3441.9424">200 {released:true}</text></g><!--SRC=[tLRVRnCv47xVlsBK1sZ9Bue43wiB4g8KxWfjrURkU42AdDr9OtPZBsid9Jhnlz_CE9jcsGr1Y0g9F6pMuyzU-_k-6ViXdA1NEiSKfhczXQaj8TKkWubACZHf5BbC6oYjmoXIYQVkbxb6uwD2bLudkb36my6RqUWItYYJvbWUW7BLUntr5fL3UAcI6Gf8tkgGIxNAhKhXkh0s5v2yrK6ymFurhILCSqBDEk1rRYSgXtSBZvy54W9VVGhBNeQhBTGPhgHHnvqIE_3M9fbWkCMDA5LUJNW_1tDYSF07JVMy_z5P8x1t56Fe5invvJ7W1XmDk-FW2RLs0BMPshjP1VqdXRRGVbwGOe7rqRmuqMKK3OVm8lcqq2N2S1W5mQ3tl58bXikBwn4CbiS35M3HkeT1J6TC6rOfR-AGbd4KSOpx0eynvCJ08Ph4fcGSGQmfxsqciDbcLCNhUfpWgrZxY8hbc5r9G_W1KmeUHLLN-y2AznXA91lzTNrn7bMnhH4i6NI0dZTmI9v-LPRdrf_QXKcFMXQnCBo0blryrL7HKmjlyxx-Bl-D-UFRl6z0EQV9MATTc1B5sjn0F8IYn6NdkAcJf848jIZ852I736-NR8SYksXlOVMsr1x18vcEkQKbkfL9kiIsKNDiezhWxVXkl_V8RVr3MqH9cOaXuJzmHXLkPlqTW16I8J4yUVouIfmhT8Kr3Z-OzxtJ84DlPAaaIdQT8HOlShtScryP0HK3c_CqLvXRcosA862aSX_YCDC-0lg5LfkVPCUOLyKLvjev6R8dhHdIx_VXq95uOWLscyDF2ref7d5Vn8V0TxWEFnV4cXihVx_Maup-XIugSKhRdEttqSOYOfZNwALux_FB3VgnrFycvrTKq6IEtINvHqdUd2lhihavTUe8FgUesXPef1OBjcTDlhfFGHvPrvUIqf5bxUJRULhE_8EPqQAmT36y6gcRBhplqQTx_r14MyFDPZB_BHR-Bdc2sviAoILbRT51OkS5NPM2LQMdlYDj-w8bOaOtf8RE__8a6w6xd5cOK8g98t-kxk6-GAMHgAlAEYlRN5HW5oOsNN5Ga1rmC_NawRF6T78cm0D8Shes2hRDH-7825DH3zzesWmPqhxfo7lAVP5MgARzJLOUtRUgtpBugdFSXRk1ltS132cml_xznnCjgxohKziDp7xvaMozGZaVzsLg6M3V4ay0GwFptrkmjBJLdMAdLcksqjYN2_mI_Gy0]--></g></svg>