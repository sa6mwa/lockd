<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="2390px" preserveAspectRatio="none" style="width:1234px;height:2390px;background:#FFFFFF;" version="1.1" viewBox="0 0 1234 2390" width="1234px" zoomAndPan="magnify">
  <rect width="100%" height="100%" fill="#ffffff"/><title>XA queue dequeue (message + optional state)</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="318.9188" x="453.9963" y="29.9659">XA queue dequeue (message + optional state)</text><rect fill="none" height="236.336" style="stroke:#000000;stroke-width:1.5;" width="822.5942" x="385.3173" y="204.5479"/><rect fill="none" height="170.924" style="stroke:#000000;stroke-width:1.5;" width="802.5942" x="395.3173" y="262.9599"/><rect fill="none" height="118.5301" style="stroke:#000000;stroke-width:1.5;" width="802.5942" x="395.3173" y="454.8839"/><rect fill="none" height="200.924" style="stroke:#000000;stroke-width:1.5;" width="822.5942" x="385.3173" y="619.12"/><rect fill="none" height="135.512" style="stroke:#000000;stroke-width:1.5;" width="802.5942" x="395.3173" y="677.532"/><rect fill="none" height="367.1601" style="stroke:#000000;stroke-width:1.5;" width="842.5942" x="375.3173" y="865.75"/><rect fill="none" height="118.5301" style="stroke:#000000;stroke-width:1.5;" width="802.5942" x="395.3173" y="892.456"/><rect fill="none" height="200.924" style="stroke:#000000;stroke-width:1.5;" width="822.5942" x="385.3173" y="1024.9861"/><rect fill="none" height="135.512" style="stroke:#000000;stroke-width:1.5;" width="802.5942" x="395.3173" y="1083.3982"/><rect fill="none" height="200.924" style="stroke:#000000;stroke-width:1.5;" width="536.143" x="671.7685" y="1373.7342"/><rect fill="none" height="135.512" style="stroke:#000000;stroke-width:1.5;" width="516.143" x="681.7685" y="1432.1462"/><rect fill="none" height="703.9263" style="stroke:#000000;stroke-width:1.5;" width="822.5942" x="385.3173" y="1588.6582"/><rect fill="none" height="195.9421" style="stroke:#000000;stroke-width:1.5;" width="802.5942" x="395.3173" y="1615.3642"/><rect fill="none" height="132.5301" style="stroke:#000000;stroke-width:1.5;" width="802.5942" x="395.3173" y="1825.3063"/><rect fill="none" height="181.9421" style="stroke:#000000;stroke-width:1.5;" width="802.5942" x="395.3173" y="1988.8183"/><rect fill="none" height="100.8241" style="stroke:#000000;stroke-width:1.5;" width="802.5942" x="395.3173" y="2184.7604"/><g><title>client SDK operation</title><rect fill="#000000" fill-opacity="0.00000" height="2199.4486" width="8" x="74.8987" y="110.1358"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="78" x2="78" y1="110.1358" y2="2309.5845"/></g><g><title>lockd RM .queue.</title><rect fill="#000000" fill-opacity="0.00000" height="2199.4486" width="8" x="465.157" y="110.1358"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="468.3173" x2="468.3173" y1="110.1358" y2="2309.5845"/></g><g><title>lockd TC leader</title><rect fill="#000000" fill-opacity="0.00000" height="2199.4486" width="8" x="744.9933" y="110.1358"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="748.7685" x2="748.7685" y1="110.1358" y2="2309.5845"/></g><g><title>Queue backend</title><rect fill="#000000" fill-opacity="0.00000" height="2199.4486" width="8" x="1129.1676" y="110.1358"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1132.4239" x2="1132.4239" y1="110.1358" y2="2309.5845"/></g><g class="participant participant-head" data-participant="SDK"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="147.7975" x="5" y="76.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="133.7975" x="12" y="98.0339">client SDK operation</text></g><g class="participant participant-tail" data-participant="SDK"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="147.7975" x="5" y="2308.5845"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="133.7975" x="12" y="2330.5504">client SDK operation</text></g><g class="participant participant-head" data-participant="RM"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="127.6795" x="405.3173" y="76.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113.6795" x="412.3173" y="98.0339">lockd RM (queue)</text></g><g class="participant participant-tail" data-participant="RM"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="127.6795" x="405.3173" y="2308.5845"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113.6795" x="412.3173" y="2330.5504">lockd RM (queue)</text></g><g class="participant participant-head" data-participant="TC"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="114.4496" x="691.7685" y="76.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="100.4496" x="698.7685" y="98.0339">lockd TC leader</text></g><g class="participant participant-tail" data-participant="TC"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="114.4496" x="691.7685" y="2308.5845"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="100.4496" x="698.7685" y="2330.5504">lockd TC leader</text></g><g class="participant participant-head" data-participant="Store"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103.4876" x="1078.4239" y="106.0339">Queue backend</text><path d="M1115.1676,55.0679 C1115.1676,45.0679 1133.1676,45.0679 1133.1676,45.0679 C1133.1676,45.0679 1151.1676,45.0679 1151.1676,55.0679 L1151.1676,81.0679 C1151.1676,91.0679 1133.1676,91.0679 1133.1676,91.0679 C1133.1676,91.0679 1115.1676,91.0679 1115.1676,81.0679 L1115.1676,55.0679" fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;"/><path d="M1115.1676,55.0679 C1115.1676,65.0679 1133.1676,65.0679 1133.1676,65.0679 C1133.1676,65.0679 1151.1676,65.0679 1151.1676,55.0679" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="Store"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103.4876" x="1078.4239" y="2323.5504">Queue backend</text><path d="M1115.1676,2337.6524 C1115.1676,2327.6524 1133.1676,2327.6524 1133.1676,2327.6524 C1133.1676,2327.6524 1151.1676,2327.6524 1151.1676,2337.6524 L1151.1676,2363.6524 C1151.1676,2373.6524 1133.1676,2373.6524 1133.1676,2373.6524 C1133.1676,2373.6524 1115.1676,2373.6524 1115.1676,2363.6524 L1115.1676,2337.6524" fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;"/><path d="M1115.1676,2337.6524 C1115.1676,2347.6524 1133.1676,2347.6524 1133.1676,2347.6524 C1133.1676,2347.6524 1151.1676,2347.6524 1151.1676,2337.6524" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1227.9114" x="0" y="141.9888"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1227.9114" y1="141.9888" y2="141.9888"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1227.9114" y1="144.9888" y2="144.9888"/><rect fill="#EEEEEE" height="25.706" style="stroke:#000000;stroke-width:2;" width="150.6301" x="538.6407" y="130.1358"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="133.2501" x="544.6407" y="148.0328">Dequeue with txn_id</text><g class="message" data-participant-1="SDK" data-participant-2="RM"><polygon fill="#181818" points="457.157,185.5479,467.157,189.5479,457.157,193.5479,461.157,189.5479" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="78.8987" x2="463.157" y1="189.5479" y2="189.5479"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7.436" x="85.8987" y="183.7389">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="296.2703" x="97.3347" y="183.7389">POST /v1/queue/dequeue (queue, owner, txn_id)</text></g><path d="M385.3173,204.5479 L458.6053,204.5479 L458.6053,214.2539 L448.6053,224.2539 L385.3173,224.2539 L385.3173,204.5479" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="236.336" style="stroke:#000000;stroke-width:1.5;" width="822.5942" x="385.3173" y="204.5479"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28.288" x="400.3173" y="219.4449">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="148.3119" x="473.6053" y="218.3068">[CAS retry (message lease)]</text><g class="message" data-participant-1="RM" data-participant-2="Store"><polygon fill="#181818" points="1121.1676,243.9599,1131.1676,247.9599,1121.1676,251.9599,1125.1676,247.9599" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="469.157" x2="1127.1676" y1="247.9599" y2="247.9599"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7.436" x="476.157" y="242.1509">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="200.2522" x="487.593" y="242.1509">load_meta(q/&lt;queue&gt;/msg/&lt;id&gt;)</text></g><path d="M395.3173,262.9599 L457.7763,262.9599 L457.7763,272.6659 L447.7763,282.6659 L395.3173,282.6659 L395.3173,262.9599" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="170.924" style="stroke:#000000;stroke-width:1.5;" width="802.5942" x="395.3173" y="262.9599"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.459" x="410.3173" y="277.8569">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="81.4984" x="472.7763" y="276.7188">[meta missing]</text><g class="message" data-participant-1="RM" data-participant-2="Store"><polygon fill="#181818" points="1121.1676,337.784,1131.1676,341.784,1121.1676,345.784,1125.1676,341.784" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="469.157" x2="1127.1676" y1="341.784" y2="341.784"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7.436" x="476.157" y="318.2689">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183.0401" x="487.593" y="300.5629">store_meta(expected_etag="",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="241.5531" x="487.593" y="318.2689">lease_id, lease_owner, lease_expires_at,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185.7702" x="487.593" y="335.975">lease_txn_id, fencing_token++)</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="395.3173" x2="1197.9114" y1="350.784" y2="350.784"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="81.2894" x="400.3173" y="362.5429">[meta present]</text><g class="message" data-participant-1="RM" data-participant-2="Store"><polygon fill="#181818" points="1121.1676,421.8839,1131.1676,425.8839,1121.1676,429.8839,1125.1676,425.8839" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="469.157" x2="1127.1676" y1="425.8839" y2="425.8839"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7.436" x="476.157" y="402.3689">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="236.9902" x="487.593" y="384.6629">store_meta(expected_etag=meta_etag,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="241.5531" x="487.593" y="402.3689">lease_id, lease_owner, lease_expires_at,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185.7702" x="487.593" y="420.0749">lease_txn_id, fencing_token++)</text></g><path d="M395.3173,454.8839 L468.6053,454.8839 L468.6053,464.5899 L458.6053,474.5899 L395.3173,474.5899 L395.3173,454.8839" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="118.5301" style="stroke:#000000;stroke-width:1.5;" width="802.5942" x="395.3173" y="454.8839"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28.288" x="410.3173" y="469.7809">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="139.27" x="483.6053" y="468.6428">[CAS retry (message doc)]</text><g class="message" data-participant-1="RM" data-participant-2="Store"><polygon fill="#181818" points="1121.1676,494.2959,1131.1676,498.2959,1121.1676,502.2959,1125.1676,498.2959" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="469.157" x2="1127.1676" y1="498.2959" y2="498.2959"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7.436" x="476.157" y="492.4869">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185.8092" x="487.593" y="492.4869">get_message_doc(queue/&lt;id&gt;)</text></g><g class="message" data-participant-1="RM" data-participant-2="Store"><polygon fill="#181818" points="1121.1676,561.414,1131.1676,565.414,1121.1676,569.414,1125.1676,565.414" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="469.157" x2="1127.1676" y1="565.414" y2="565.414"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7.436" x="476.157" y="541.899">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="267.8132" x="487.593" y="524.1929">put_message_doc(expected_etag=doc_etag,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="263.3152" x="487.593" y="541.899">lease_id, lease_txn_id, lease_fencing_token,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178.5422" x="487.593" y="559.605">attempts++, not_visible_until)</text></g><g class="message" data-participant-1="RM" data-participant-2="Store"><polygon fill="#181818" points="1121.1676,600.12,1131.1676,604.12,1121.1676,608.12,1125.1676,604.12" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="469.157" x2="1127.1676" y1="604.12" y2="604.12"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7.436" x="476.157" y="598.311">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151.8011" x="487.593" y="598.311">get_payload(queue/&lt;id&gt;)</text></g><path d="M385.3173,619.12 L458.6053,619.12 L458.6053,628.826 L448.6053,638.826 L385.3173,638.826 L385.3173,619.12" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="200.924" style="stroke:#000000;stroke-width:1.5;" width="822.5942" x="385.3173" y="619.12"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28.288" x="400.3173" y="634.017">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="125.7731" x="473.6053" y="632.8789">[CAS retry (txn record)]</text><g class="message" data-participant-1="RM" data-participant-2="Store"><polygon fill="#181818" points="1121.1676,658.532,1131.1676,662.532,1121.1676,666.532,1125.1676,662.532" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="469.157" x2="1127.1676" y1="662.532" y2="662.532"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7.436" x="476.157" y="656.723">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184.8862" x="487.593" y="656.723">get_txn_record(.txns/&lt;txn_id&gt;)</text></g><path d="M395.3173,677.532 L457.7763,677.532 L457.7763,687.2381 L447.7763,697.2381 L395.3173,697.2381 L395.3173,677.532" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="135.512" style="stroke:#000000;stroke-width:1.5;" width="802.5942" x="395.3173" y="677.532"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.459" x="410.3173" y="692.429">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="109.9112" x="472.7763" y="691.2909">[txn record missing]</text><g class="message" data-participant-1="RM" data-participant-2="Store"><polygon fill="#181818" points="1121.1676,734.6501,1131.1676,738.6501,1121.1676,742.6501,1125.1676,738.6501" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="469.157" x2="1127.1676" y1="738.6501" y2="738.6501"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7.436" x="476.157" y="723.9881">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187.8372" x="487.593" y="715.1351">put_txn_record(state=pending,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="338.1173" x="487.593" y="732.8411">participants+=q/&lt;queue&gt;/msg/&lt;id&gt;) (expected_etag="")</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="395.3173" x2="1197.9114" y1="747.6501" y2="747.6501"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="99.1973" x="400.3173" y="759.409">[txn record exists]</text><g class="message" data-participant-1="RM" data-participant-2="Store"><polygon fill="#181818" points="1121.1676,801.044,1131.1676,805.044,1121.1676,809.044,1125.1676,805.044" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="469.157" x2="1127.1676" y1="805.044" y2="805.044"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14.872" x="476.157" y="790.382">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187.8372" x="495.0291" y="781.529">put_txn_record(state=pending,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="380.1984" x="495.0291" y="799.235">participants+=q/&lt;queue&gt;/msg/&lt;id&gt;) (expected_etag=txn_etag)</text></g><g class="message" data-participant-1="RM" data-participant-2="SDK"><polygon fill="#181818" points="89.8987,846.75,79.8987,850.75,89.8987,854.75,85.8987,850.75" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="83.8987" x2="468.157" y1="850.75" y2="850.75"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14.872" x="95.8987" y="844.941">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="347.3863" x="114.7708" y="844.941">message + lease_id + txn_id + meta_etag + fencing_token</text></g><path d="M375.3173,865.75 L442.2353,865.75 L442.2353,875.456 L432.2353,885.456 L375.3173,885.456 L375.3173,865.75" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="367.1601" style="stroke:#000000;stroke-width:1.5;" width="842.5942" x="375.3173" y="865.75"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21.918" x="390.3173" y="880.647">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="101.0233" x="457.2353" y="879.5089">[stateful dequeue]</text><path d="M395.3173,892.456 L468.6053,892.456 L468.6053,902.1621 L458.6053,912.1621 L395.3173,912.1621 L395.3173,892.456" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="118.5301" style="stroke:#000000;stroke-width:1.5;" width="802.5942" x="395.3173" y="892.456"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28.288" x="410.3173" y="907.3531">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="128.1271" x="483.6053" y="906.215">[CAS retry (state lease)]</text><g class="message" data-participant-1="RM" data-participant-2="Store"><polygon fill="#181818" points="1121.1676,931.8681,1131.1676,935.8681,1121.1676,939.8681,1125.1676,935.8681" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="469.157" x2="1127.1676" y1="935.8681" y2="935.8681"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14.872" x="476.157" y="930.0591">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204.1132" x="495.0291" y="930.0591">load_meta(q/&lt;queue&gt;/state/&lt;id&gt;)</text></g><g class="message" data-participant-1="RM" data-participant-2="Store"><polygon fill="#181818" points="1121.1676,998.9861,1131.1676,1002.9861,1121.1676,1006.9861,1125.1676,1002.9861" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="469.157" x2="1127.1676" y1="1002.9861" y2="1002.9861"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14.872" x="476.157" y="979.4711">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="236.9902" x="495.0291" y="961.7651">store_meta(expected_etag=meta_etag,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="216.0341" x="495.0291" y="979.4711">lease_id, lease_owner, lease_txn_id,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104.8711" x="495.0291" y="997.1771">fencing_token++)</text></g><path d="M385.3173,1024.9861 L458.6053,1024.9861 L458.6053,1034.6921 L448.6053,1044.6921 L385.3173,1044.6921 L385.3173,1024.9861" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="200.924" style="stroke:#000000;stroke-width:1.5;" width="822.5942" x="385.3173" y="1024.9861"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28.288" x="400.3173" y="1039.8831">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="125.7731" x="473.6053" y="1038.745">[CAS retry (txn record)]</text><g class="message" data-participant-1="RM" data-participant-2="Store"><polygon fill="#181818" points="1121.1676,1064.3982,1131.1676,1068.3982,1121.1676,1072.3982,1125.1676,1068.3982" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="469.157" x2="1127.1676" y1="1068.3982" y2="1068.3982"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14.872" x="476.157" y="1062.5892">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184.8862" x="495.0291" y="1062.5892">get_txn_record(.txns/&lt;txn_id&gt;)</text></g><path d="M395.3173,1083.3982 L457.7763,1083.3982 L457.7763,1093.1042 L447.7763,1103.1042 L395.3173,1103.1042 L395.3173,1083.3982" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="135.512" style="stroke:#000000;stroke-width:1.5;" width="802.5942" x="395.3173" y="1083.3982"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.459" x="410.3173" y="1098.2952">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="109.9112" x="472.7763" y="1097.1571">[txn record missing]</text><g class="message" data-participant-1="RM" data-participant-2="Store"><polygon fill="#181818" points="1121.1676,1140.5162,1131.1676,1144.5162,1121.1676,1148.5162,1125.1676,1144.5162" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="469.157" x2="1127.1676" y1="1144.5162" y2="1144.5162"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14.872" x="476.157" y="1129.8542">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187.8372" x="495.0291" y="1121.0012">put_txn_record(state=pending,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="341.9783" x="495.0291" y="1138.7072">participants+=q/&lt;queue&gt;/state/&lt;id&gt;) (expected_etag="")</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="395.3173" x2="1197.9114" y1="1153.5162" y2="1153.5162"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="99.1973" x="400.3173" y="1165.2751">[txn record exists]</text><g class="message" data-participant-1="RM" data-participant-2="Store"><polygon fill="#181818" points="1121.1676,1206.9101,1131.1676,1210.9101,1121.1676,1214.9101,1125.1676,1210.9101" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="469.157" x2="1127.1676" y1="1210.9101" y2="1210.9101"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14.872" x="476.157" y="1196.2481">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187.8372" x="495.0291" y="1187.3951">put_txn_record(state=pending,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="384.0593" x="495.0291" y="1205.1011">participants+=q/&lt;queue&gt;/state/&lt;id&gt;) (expected_etag=txn_etag)</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1227.9114" x="0" y="1261.7631"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1227.9114" y1="1261.7631" y2="1261.7631"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1227.9114" y1="1264.7631" y2="1264.7631"/><rect fill="#EEEEEE" height="25.706" style="stroke:#000000;stroke-width:2;" width="111.1101" x="558.4007" y="1249.9101"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="93.7301" x="564.4007" y="1267.8071">Decide + apply</text><g class="message" data-participant-1="SDK" data-participant-2="RM"><polygon fill="#181818" points="457.157,1305.3222,467.157,1309.3222,457.157,1313.3222,461.157,1309.3222" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="78.8987" x2="463.157" y1="1309.3222" y2="1309.3222"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14.872" x="85.8987" y="1303.5132">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="239.2912" x="104.7708" y="1303.5132">POST /v1/queue/ack or /v1/queue/nack</text></g><g class="message" data-participant-1="RM" data-participant-2="TC"><polygon fill="#181818" points="736.9933,1354.7342,746.9933,1358.7342,736.9933,1362.7342,740.9933,1358.7342" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="469.157" x2="742.9933" y1="1358.7342" y2="1358.7342"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14.872" x="476.157" y="1344.0722">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="236.9642" x="495.0291" y="1335.2192">POST /v1/txn/decide (commit|rollback,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.5581" x="495.0291" y="1352.9252">participants, tc_term)</text></g><path d="M671.7685,1373.7342 L745.0565,1373.7342 L745.0565,1383.4402 L735.0565,1393.4402 L671.7685,1393.4402 L671.7685,1373.7342" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="200.924" style="stroke:#000000;stroke-width:1.5;" width="536.143" x="671.7685" y="1373.7342"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28.288" x="686.7685" y="1388.6312">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="125.7731" x="760.0565" y="1387.4931">[CAS retry (txn record)]</text><g class="message" data-participant-1="TC" data-participant-2="Store"><polygon fill="#181818" points="1121.1676,1413.1462,1131.1676,1417.1462,1121.1676,1421.1462,1125.1676,1417.1462" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="748.9933" x2="1127.1676" y1="1417.1462" y2="1417.1462"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14.872" x="755.9933" y="1411.3372">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184.8862" x="774.8653" y="1411.3372">get_txn_record(.txns/&lt;txn_id&gt;)</text></g><path d="M681.7685,1432.1462 L744.2275,1432.1462 L744.2275,1441.8522 L734.2275,1451.8522 L681.7685,1451.8522 L681.7685,1432.1462" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="135.512" style="stroke:#000000;stroke-width:1.5;" width="516.143" x="681.7685" y="1432.1462"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.459" x="696.7685" y="1447.0432">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="109.9112" x="759.2275" y="1445.9051">[txn record missing]</text><g class="message" data-participant-1="TC" data-participant-2="Store"><polygon fill="#181818" points="1121.1676,1489.2643,1131.1676,1493.2643,1121.1676,1497.2643,1125.1676,1493.2643" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="748.9933" x2="1127.1676" y1="1493.2643" y2="1493.2643"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14.872" x="755.9933" y="1478.6023">20</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="239.1352" x="774.8653" y="1469.7493">put_txn_record(state=commit|rollback,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="299.2213" x="774.8653" y="1487.4553">participants merged, tc_term) (expected_etag="")</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="681.7685" x2="1197.9114" y1="1502.2643" y2="1502.2643"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="99.1973" x="686.7685" y="1514.0232">[txn record exists]</text><g class="message" data-participant-1="TC" data-participant-2="Store"><polygon fill="#181818" points="1121.1676,1555.6582,1131.1676,1559.6582,1121.1676,1563.6582,1125.1676,1559.6582" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="748.9933" x2="1127.1676" y1="1559.6582" y2="1559.6582"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14.872" x="755.9933" y="1544.9962">21</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="239.1352" x="774.8653" y="1536.1432">put_txn_record(state=commit|rollback,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="341.3024" x="774.8653" y="1553.8492">participants merged, tc_term) (expected_etag=txn_etag)</text></g><path d="M385.3173,1588.6582 L447.7763,1588.6582 L447.7763,1598.3642 L437.7763,1608.3642 L385.3173,1608.3642 L385.3173,1588.6582" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="703.9263" style="stroke:#000000;stroke-width:1.5;" width="822.5942" x="385.3173" y="1588.6582"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.459" x="400.3173" y="1603.5552">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="81.6964" x="462.7763" y="1602.4171">[commit (ACK)]</text><path d="M395.3173,1615.3642 L468.6053,1615.3642 L468.6053,1625.0702 L458.6053,1635.0702 L395.3173,1635.0702 L395.3173,1615.3642" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="195.9421" style="stroke:#000000;stroke-width:1.5;" width="802.5942" x="395.3173" y="1615.3642"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28.288" x="410.3173" y="1630.2612">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="165.2078" x="483.6053" y="1629.1231">[CAS retry (message removal)]</text><g class="message" data-participant-1="RM" data-participant-2="Store"><polygon fill="#181818" points="1121.1676,1654.7762,1131.1676,1658.7762,1121.1676,1662.7762,1125.1676,1658.7762" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="469.157" x2="1127.1676" y1="1658.7762" y2="1658.7762"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14.872" x="476.157" y="1652.9672">22</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="200.2522" x="495.0291" y="1652.9672">load_meta(q/&lt;queue&gt;/msg/&lt;id&gt;)</text></g><g class="message" data-participant-1="RM" data-participant-2="Store"><polygon fill="#181818" points="1121.1676,1686.4823,1131.1676,1690.4823,1121.1676,1694.4823,1125.1676,1690.4823" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="469.157" x2="1127.1676" y1="1690.4823" y2="1690.4823"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14.872" x="476.157" y="1684.6733">23</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185.8092" x="495.0291" y="1684.6733">get_message_doc(queue/&lt;id&gt;)</text></g><g class="message" data-participant-1="RM" data-participant-2="Store"><polygon fill="#181818" points="1121.1676,1718.1883,1131.1676,1722.1883,1121.1676,1726.1883,1125.1676,1722.1883" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="469.157" x2="1127.1676" y1="1722.1883" y2="1722.1883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14.872" x="476.157" y="1716.3793">24</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="285.5452" x="495.0291" y="1716.3793">delete_message_doc(expected_etag=doc_etag)</text></g><g class="message" data-participant-1="RM" data-participant-2="Store"><polygon fill="#181818" points="1121.1676,1749.8943,1131.1676,1753.8943,1121.1676,1757.8943,1125.1676,1753.8943" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="469.157" x2="1127.1676" y1="1753.8943" y2="1753.8943"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14.872" x="476.157" y="1748.0853">25</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="277.8622" x="495.0291" y="1748.0853">delete_payload(expected_etag=payload_etag)</text></g><g class="message" data-participant-1="RM" data-participant-2="Store"><polygon fill="#181818" points="1121.1676,1799.3063,1131.1676,1803.3063,1121.1676,1807.3063,1125.1676,1803.3063" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="469.157" x2="1127.1676" y1="1803.3063" y2="1803.3063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14.872" x="476.157" y="1788.6443">26</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="236.9902" x="495.0291" y="1779.7913">store_meta(expected_etag=meta_etag,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68.406" x="495.0291" y="1797.4973">clear lease)</text></g><path d="M395.3173,1825.3063 L462.2353,1825.3063 L462.2353,1835.0123 L452.2353,1845.0123 L395.3173,1845.0123 L395.3173,1825.3063" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="132.5301" style="stroke:#000000;stroke-width:1.5;" width="802.5942" x="395.3173" y="1825.3063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21.918" x="410.3173" y="1840.2033">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="114.4872" x="477.2353" y="1839.0652">[stateful participant]</text><g class="message" data-participant-1="RM" data-participant-2="Store"><polygon fill="#181818" points="1121.1676,1864.7184,1131.1676,1868.7184,1121.1676,1872.7184,1125.1676,1868.7184" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="469.157" x2="1127.1676" y1="1868.7184" y2="1868.7184"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14.872" x="476.157" y="1862.9094">27</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204.1132" x="495.0291" y="1862.9094">load_meta(q/&lt;queue&gt;/state/&lt;id&gt;)</text></g><g class="message" data-participant-1="RM" data-participant-2="Store"><polygon fill="#181818" points="1121.1676,1896.4244,1131.1676,1900.4244,1121.1676,1904.4244,1125.1676,1900.4244" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="469.157" x2="1127.1676" y1="1900.4244" y2="1900.4244"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14.872" x="476.157" y="1894.6154">28</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="241.4882" x="495.0291" y="1894.6154">delete_state(expected_etag=state_etag)</text></g><g class="message" data-participant-1="RM" data-participant-2="Store"><polygon fill="#181818" points="1121.1676,1945.8364,1131.1676,1949.8364,1121.1676,1953.8364,1125.1676,1949.8364" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="469.157" x2="1127.1676" y1="1949.8364" y2="1949.8364"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14.872" x="476.157" y="1935.1744">29</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="236.9902" x="495.0291" y="1926.3214">store_meta(expected_etag=meta_etag,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68.406" x="495.0291" y="1944.0274">clear lease)</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="385.3173" x2="1207.9114" y1="1965.8364" y2="1965.8364"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="93.0373" x="390.3173" y="1977.5953">[rollback (NACK)]</text><path d="M395.3173,1988.8183 L468.6053,1988.8183 L468.6053,1998.5243 L458.6053,2008.5243 L395.3173,2008.5243 L395.3173,1988.8183" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="181.9421" style="stroke:#000000;stroke-width:1.5;" width="802.5942" x="395.3173" y="1988.8183"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28.288" x="410.3173" y="2003.7153">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="180.2337" x="483.6053" y="2002.5772">[CAS retry (message reschedule)]</text><g class="message" data-participant-1="RM" data-participant-2="Store"><polygon fill="#181818" points="1121.1676,2028.2303,1131.1676,2032.2303,1121.1676,2036.2303,1125.1676,2032.2303" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="469.157" x2="1127.1676" y1="2032.2303" y2="2032.2303"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14.872" x="476.157" y="2026.4213">30</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="200.2522" x="495.0291" y="2026.4213">load_meta(q/&lt;queue&gt;/msg/&lt;id&gt;)</text></g><g class="message" data-participant-1="RM" data-participant-2="Store"><polygon fill="#181818" points="1121.1676,2059.9363,1131.1676,2063.9363,1121.1676,2067.9363,1125.1676,2063.9363" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="469.157" x2="1127.1676" y1="2063.9363" y2="2063.9363"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14.872" x="476.157" y="2058.1273">31</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185.8092" x="495.0291" y="2058.1273">get_message_doc(queue/&lt;id&gt;)</text></g><g class="message" data-participant-1="RM" data-participant-2="Store"><polygon fill="#181818" points="1121.1676,2109.3484,1131.1676,2113.3484,1121.1676,2117.3484,1125.1676,2113.3484" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="469.157" x2="1127.1676" y1="2113.3484" y2="2113.3484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14.872" x="476.157" y="2098.6864">32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="267.8132" x="495.0291" y="2089.8334">put_message_doc(expected_etag=doc_etag,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.0952" x="495.0291" y="2107.5394">clear lease, not_visible_until)</text></g><g class="message" data-participant-1="RM" data-participant-2="Store"><polygon fill="#181818" points="1121.1676,2158.7604,1131.1676,2162.7604,1121.1676,2166.7604,1125.1676,2162.7604" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="469.157" x2="1127.1676" y1="2162.7604" y2="2162.7604"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14.872" x="476.157" y="2148.0984">33</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="236.9902" x="495.0291" y="2139.2454">store_meta(expected_etag=meta_etag,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158.5221" x="495.0291" y="2156.9514">clear lease, visibility reset)</text></g><path d="M395.3173,2184.7604 L462.2353,2184.7604 L462.2353,2194.4664 L452.2353,2204.4664 L395.3173,2204.4664 L395.3173,2184.7604" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="100.8241" style="stroke:#000000;stroke-width:1.5;" width="802.5942" x="395.3173" y="2184.7604"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21.918" x="410.3173" y="2199.6574">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="114.4872" x="477.2353" y="2198.5193">[stateful participant]</text><g class="message" data-participant-1="RM" data-participant-2="Store"><polygon fill="#181818" points="1121.1676,2224.1724,1131.1676,2228.1724,1121.1676,2232.1724,1125.1676,2228.1724" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="469.157" x2="1127.1676" y1="2228.1724" y2="2228.1724"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14.872" x="476.157" y="2222.3634">34</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204.1132" x="495.0291" y="2222.3634">load_meta(q/&lt;queue&gt;/state/&lt;id&gt;)</text></g><g class="message" data-participant-1="RM" data-participant-2="Store"><polygon fill="#181818" points="1121.1676,2273.5845,1131.1676,2277.5845,1121.1676,2281.5845,1125.1676,2277.5845" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="469.157" x2="1127.1676" y1="2277.5845" y2="2277.5845"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14.872" x="476.157" y="2262.9225">35</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="236.9902" x="495.0291" y="2254.0695">store_meta(expected_etag=meta_etag,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68.406" x="495.0291" y="2271.7755">clear lease)</text></g><!--SRC=[lLPDR-8m4BtdLumuWM0NxRKgbIfwgxeVBOSzL8fCFALMdJYr9ssHziVls4aWWK1Xb_OGsN76Cs_6psz2YZJ2xqjuBh10a5YE_HIT4mk48PYSbCc41aU2S129WanMf7EqKPGBIofHkSW8UebMoEFTrJNlGIlyjXu8vrVQbjeaJn9kRw0VeWs2rUrDbz5i2Xg5H1jiPjD82X9puH1wlmBIkKYUC9Db838MesWoWQigZrT5Zq1lMQmaJ2QHn_RbWaETmSyVTpCOltmR1yFnAl4mZC2yPcX7rTP1f8t9ONfv1nR9BjVbOMoEQm8-6NOS09o1DaB6APBeFu_FWyEBSUeMutCbBxonq0J-CwJAEPKjU6d3W_D3wGBVSam8PSmlYqclDxhFGbJ6DIhZnnNOyeNjbKKN2rfPbbcCu06pXCF5PBXamw67WffB6R3al8dFxmWiVYdCJWmfav5_TjLSccIhuWkakFeUy_Vo55VrRfdcHTkqdHElx4gfXbo-jO2pjI32D2St78uWCnI_AAVc6kCY8wK78Q4jnBbOUggqq6vcpL5vcXWhEvFseChF_QyyT-Fp4kQAP-lzkzdcIz9m52xw96V8RCsfDQwb6quwA0rR95rHgn4UtvGZz_7HlIy_QNB91_GHhwxFO2rjzGdpjDA88Qn8pVFM6KSHAs4fWW-5hfMIOsoUM31PAyC1sX1shDXwykjN4VS-st7PjbDea-vOskqbtcaElr6nRlBjfT-7OsXIiAvnJSMoFILAUWQAFDVB_Ps9-niOsrZ8UANIajcqOSv1kOq5n_t4fAcYFzPexHlaHXRSrvAOqARloGrttzF8JSjHPxtt8-PhQHSery2FbfmFHz0bEv4lIUaN-fVJwq77NQlbo69gNeG-K3AQlnD7zS8DOuaQ2GzeYBltrbsilQzQtRNt85LBMB_iMadBUzHIuSO9dK1gguI2pGQii7RgP09TQxv1__kx37798yf2uoUJvE1VfaQEdNz1_rsv4GIFIYjQ-deWVGen_lc0-VaB]--></g></svg>